{
  "log": { "loglevel": "debug" },
  "dns": {
    "tag": "dnsIn",                 // v2ray 内建 DNS 服务器发出的流量的标签，用于 routing 匹配
    "servers":[
      {
        "address": "10.72.66.36",   
        "port": 53,
        "domains": [
          "domain:h3c.com"          // 指定域名使用指定 DNS 服务器解析
        ]
      },      
      "223.5.5.5",
      "localhost"
    ]
  },
  "inbounds":[
    {
      "tag": "ladderSocksIn",
      "protocol": "socks",
      "port": 12345,
      "listen": "127.0.0.1",
      "settings": {
        "auth": "noauth"
      }
    }
  ],
  "outbounds": [
   {
      "tag": "wsLadderOut",
      "protocol": "vmess",
      "settings": {
        "vnext": [
          {
            "address": "1291114093.ml",
            "port": 443,
            "users": [
              { "id":"d45499fa-6c4b-3e55-adbb-bd50bc4137b8", "security":"chacha20-poly1305", "alterId":4, "level":0 }
            ]
          }
        ]
      },
      "streamSettings": {
        "network": "ws",
        "wsSettings": {
          "path": "/v2ray/ladder/ws",
           "headers": {
            "Host": "1291114093.ml"
            }        
        },
        "security": "tls", 
        "tlsSettings": {
          "serverName": "1291114093.ml"
        }
      }
    }, 
    /** todo 用于将 bridge 流量转发到 vps */
    {
      "tag":"companyReverseOut", 
      "protocol":"vmess",
      "settings":{  
        "vnext":[  
          {  
            "address":"1291114093.ml",
            "port":443,
            "users":[  
              { "id":"d45499fa-6c4b-3e55-adbb-bd50bc4137b8", "security":"chacha20-poly1305", "alterId":4, "level":0 }
            ]
          }
        ]
      },
      "streamSettings": {
        "network": "ws",
        "wsSettings": {
          "path": "/v2ray/reverse/ws/company",
          "headers": {
            "Host": "1291114093.ml"
          }
        },
        "security": "tls", 
        "tlsSettings": {
          "serverName": "1291114093.ml"
        }
      }
    },    
    /** todo 直连出口 */
    {
      "tag": "freedomOut",
      "protocol": "freedom"
    }
  ],
  "reverse":{
    "bridges":[
      {"tag":"bridge1", "domain":"ksf.reverse.kasei.haku"} 
    ]
  },
  "routing": {
    "domainStrategy": "IPIfNonMatch",   // 域名策略：直接使用系统的 DNS 解析域名
    "rules":[  
      {
        "type":"field", 
        "inboundTag":["ladderSocksIn"],
        "outboundTag":"wsLadderOut"
      },
      /** todo bridge1 流入的数据，domain == ksf.reverse.kasei.haku 的流量，转发到 vps */
      {
        "type": "field",
        "inboundTag": ["bridge1"],
        "domain": ["full:ksf.reverse.kasei.haku"],    
        "outboundTag": "companyReverseOut"
      },
      /** todo bridge1 流入的数据，domain != ksf.reverse.kasei.haku 的流量直连 */
      {
        "type": "field",
        "inboundTag": ["dnsIn", "bridge1"],              
        "outboundTag": "freedomOut"
      }    
    ] 
  }
}
